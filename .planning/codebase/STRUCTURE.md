# Codebase Structure

**Analysis Date:** 2026-02-25

## Directory Layout

```text
Cobalt-Docker/
├── .github/                       # GitHub automation workflows and command prompts
│   ├── commands/                  # Gemini prompt definitions (*.toml)
│   └── workflows/                 # GitHub Actions workflows (*.yml)
├── .planning/codebase/            # Generated codebase mapping docs (this workflow output)
├── AGENTS.md                      # Agent-specific repo contracts and guardrails
├── Dockerfile                     # Image build instructions
├── README.md                      # Operator documentation and runtime contract
├── cobalt-docker.sh               # Canonical launcher/preflight/build-run script
└── docker-entrypoint.sh           # In-container startup and process supervision
```

## Directory Purposes

**.github/commands/**
- Purpose: Prompt definitions used by Gemini automation flows.
- Contains: `gemini-invoke.toml`, `gemini-review.toml`, `gemini-triage.toml`, `gemini-scheduled-triage.toml`.
- Key files: each file defines role/constraints for a specific automation path.
- Subdirectories: none.

**.github/workflows/**
- Purpose: Event-driven GitHub automation orchestration.
- Contains: reusable and dispatch workflows for invoke/review/triage operations.
- Key files: `gemini-dispatch.yml` routes to invoke/review/triage jobs.
- Subdirectories: none.

**Repository root scripts/docs:**
- Purpose: runtime orchestration and operational documentation.
- Contains: `cobalt-docker.sh`, `docker-entrypoint.sh`, `Dockerfile`, `README.md`, `AGENTS.md`.
- Key files: launcher and entrypoint scripts are the execution core.
- Subdirectories: none required for runtime path.

## Key File Locations

**Entry Points:**
- `cobalt-docker.sh`: host-side canonical command for build/lint/run.
- `docker-entrypoint.sh`: container entrypoint that starts and supervises processes.

**Configuration:**
- `.env` (required at runtime, gitignored): sensitive runtime configuration.
- `.env.example` (expected template per docs/agent contract): bootstrap config template.
- `.gitignore`: excludes secrets and local artifacts.

**Core Logic:**
- `cobalt-docker.sh`: environment parsing, mount probing, docker run wiring.
- `docker-entrypoint.sh`: service startup sequencing, health checks, cleanup.
- `Dockerfile`: package installation and Cobalt Strike artifact provisioning.

**Testing/Validation:**
- No dedicated test directory.
- Validation commands documented in `AGENTS.md` and `README.md`.

**Documentation:**
- `README.md`: operator-facing usage and troubleshooting.
- `AGENTS.md`: coding-agent workflow constraints.

## Naming Conventions

**Files:**
- Shell scripts use kebab-case (`cobalt-docker.sh`, `docker-entrypoint.sh`).
- Primary docs use uppercase names (`README.md`, `AGENTS.md`).
- Workflow files use `gemini-*.yml` and command files use `gemini-*.toml`.

**Directories:**
- Dot-prefixed control directories (`.github/`, `.planning/`) for automation/planning metadata.
- Flat root layout (minimal nested source directories).

**Special Patterns:**
- Generated planning artifacts live under `.planning/codebase/*.md`.
- Workflow + command filenames mirror feature intent (`invoke`, `review`, `triage`, `dispatch`).

## Where to Add New Code

**Launcher/runtime behavior changes:**
- Primary code: `cobalt-docker.sh` and/or `docker-entrypoint.sh`.
- Documentation updates: `README.md` and `AGENTS.md` contracts.
- Validation: run `bash -n` checks on modified scripts.

**Automation changes:**
- Workflow orchestration: `.github/workflows/`.
- Gemini behavior prompts: `.github/commands/`.

**New documentation artifacts:**
- Operator docs: `README.md`.
- Planning docs: `.planning/codebase/` (generated/maintained via GSD workflows).

## Special Directories

**.planning/**
- Purpose: planning/project-memory workspace used by GSD workflows.
- Source: generated by project/planning commands.
- Committed: yes, when workflow output is intended to be versioned.

---

*Structure analysis: 2026-02-25*
*Update when directory structure changes*
