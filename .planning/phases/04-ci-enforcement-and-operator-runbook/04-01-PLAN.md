---
phase: 04-ci-enforcement-and-operator-runbook
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .github/workflows/runtime-reliability-gates.yml
  - README.md
autonomous: true
requirements:
  - TEST-04
user_setup: []
must_haves:
  truths:
    - Pull requests to `master` and `release/**` run blocking runtime reliability gates in CI.
    - CI workflow enforces shell syntax checks, shell regression suite, and secret-pattern scan.
    - Workflow remains fork-safe and read-only with no secret dependencies.
  artifacts:
    - .github/workflows/runtime-reliability-gates.yml
    - README.md
  key_links:
    - CI job commands match local contributor reproduction commands.
    - README points contributors to the troubleshooting runbook for failure triage.
---

<objective>
Wire dedicated pull-request CI reliability gates that enforce existing runtime contract checks.

Purpose: satisfy TEST-04 by continuously enforcing syntax/static and shell regression checks on incoming changes.
Output: dedicated workflow with blocking jobs and aligned local reproduction guidance.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/STATE.md
@.planning/phases/04-ci-enforcement-and-operator-runbook/04-CONTEXT.md
@.planning/phases/04-ci-enforcement-and-operator-runbook/04-RESEARCH.md

@.github/workflows/
@README.md
@tests/run-shell-tests.sh
@scripts/scan-secrets.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add dedicated runtime reliability PR workflow</name>
  <files>.github/workflows/runtime-reliability-gates.yml</files>
  <action>Create a new pull-request workflow targeting `master` and `release/**` with `contents: read`, concurrency cancellation, and no secret usage.</action>
  <verify>rg -n "pull_request|master|release/\\*\\*|permissions:|contents: read|concurrency|cancel-in-progress" .github/workflows/runtime-reliability-gates.yml</verify>
  <done>Dedicated workflow exists with locked trigger scope and fork-safe policy.</done>
</task>

<task type="auto">
  <name>Task 2: Define blocking CI jobs for runtime contract checks</name>
  <files>.github/workflows/runtime-reliability-gates.yml</files>
  <action>Add blocking jobs named `syntax-checks`, `shell-regression-suite`, and `secret-scan` executing the exact required commands.</action>
  <verify>rg -n "syntax-checks|shell-regression-suite|secret-scan|bash -n|tests/run-shell-tests.sh|scan-secrets.sh" .github/workflows/runtime-reliability-gates.yml</verify>
  <done>All required checks are enforced as blocking jobs with deterministic commands.</done>
</task>

<task type="auto">
  <name>Task 3: Link CI failure troubleshooting entry point in README</name>
  <files>README.md</files>
  <action>Add/update a concise section pointing to `docs/TROUBLESHOOTING.md` so CI failures route contributors to a single runbook source.</action>
  <verify>rg -n "Troubleshooting Runbook|docs/TROUBLESHOOTING.md|CI failure" README.md</verify>
  <done>README includes clear pointer from CI failures to runbook guidance.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Workflow trigger scope and permissions match locked decisions
- [ ] Required blocking jobs run exact syntax/test/scan commands
- [ ] README points to runbook path for troubleshooting
</verification>

<success_criteria>
- TEST-04 is satisfied with deterministic pull-request CI gates.
- Contributors can reproduce CI failures locally using documented commands.
</success_criteria>

<output>
After completion, create `.planning/phases/04-ci-enforcement-and-operator-runbook/04-01-SUMMARY.md`
</output>
